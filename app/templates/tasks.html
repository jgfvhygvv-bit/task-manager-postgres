{% extends "base.html" %}

{% block title %}–ú–æ–∏ –∑–∞–¥–∞—á–∏ - Task Manager{% endblock %}

{% block content %}
<h2 class="mb-4">üìã –ú–æ–∏ –∑–∞–¥–∞—á–∏ (PostgreSQL)</h2>

<a href="/tasks/create" class="btn btn-primary mb-4">‚ûï –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É</a>

{% if tasks %}
<div class="list-group">
    {% for task in tasks %}
    <div class="list-group-item task-card {% if task.status == 'completed' %}completed{% endif %}">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h5 class="mb-1">{{ task.title }}</h5>
                <p class="mb-1">{{ task.description or "–ù–µ—Ç –æ–ø–∏—Å–∞–Ω–∏—è" }}</p>
                <small class="text-muted">
                    –°–æ–∑–¥–∞–Ω–æ: {{ task.created_at.strftime('%d.%m.%Y %H:%M') }}
                    {% if task.updated_at != task.created_at %}
                    | –û–±–Ω–æ–≤–ª–µ–Ω–æ: {{ task.updated_at.strftime('%d.%m.%Y %H:%M') }}
                    {% endif %}
                </small>
            </div>
            <div class="task-actions">
                <span class="badge bg-{% if task.status == 'completed' %}success{% else %}warning{% endif %} me-2">
                    {{ '–ó–∞–≤–µ—Ä—à–µ–Ω–æ' if task.status == 'completed' else '–í —Ä–∞–±–æ—Ç–µ' }}
                </span>

                <form action="{{ url_for('toggle_task', task_id=task.id) }}" method="POST" class="d-inline">
                    <button type="submit"
                        class="btn btn-sm btn-{% if task.status == 'completed' %}warning{% else %}success{% endif %}">
                        {{ '–í–µ—Ä–Ω—É—Ç—å –≤ —Ä–∞–±–æ—Ç—É' if task.status == 'completed' else '–ó–∞–≤–µ—Ä—à–∏—Ç—å' }}
                    </button>
                </form>

                <form action="{{ url_for('delete_task', task_id=task.id) }}" method="POST" class="d-inline"
                    onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É?')">
                    <button type="submit" class="btn btn-sm btn-danger">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                </form>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="alert alert-info">
    üì≠ –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–¥–∞—á. <a href="/tasks/create">–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–¥–∞—á—É!</a>
</div>
{% endif %}

<div class="mt-4 alert alert-secondary">
    <h6>üíæ –•—Ä–∞–Ω–µ–Ω–∏–µ –≤ PostgreSQL</h6>
    <p>–í—Å–µ –∑–∞–¥–∞—á–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö PostgreSQL. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p>
</div>
{% endblock %}